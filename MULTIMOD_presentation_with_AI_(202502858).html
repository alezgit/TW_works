<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alessandro Zocchi - Responsive Grid Layout</title>
    <style>
/* CSS remained unchanged */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #C8102E 0%, #FFB000 100%);
    min-height: 100vh;
    padding: 20px;
}

/* Main Grid Container */
.main-container {
    display: grid;
    grid-template-columns: 1fr;
    grid-template-areas:
        "profile"
        "bio"
        "links"
        "contact"
        "carousel"
        "visualizer"
        "videofilter"
        "webrtc"
        "gamelink";    
    max-width: 1200px;
    margin: 0 auto;
    gap: 20px;
}

/* Profile Section */
.profile-section {
    grid-area: profile;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(20px);
    border-radius: 25px;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
    padding: 40px;
    text-align: center;
    position: relative;
    overflow: hidden;
}

.profile-section::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 5px;
    background: linear-gradient(90deg, #C8102E, #FFB000, #C8102E, #FFB000);
    background-size: 400% 400%;
    animation: gradientShift 3s ease infinite;
}

@keyframes gradientShift {
    0%, 100% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
}

.profile-image {
    width: 150px;
    height: 150px;
    border-radius: 50%;
    border: 5px solid #fff;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
    margin: 0 auto 30px;
    object-fit: cover;
    animation: heartbeat 2s ease-in-out infinite;
}

.profile-image:hover {
    animation-play-state: paused;
    transform: scale(1.08);
}

@keyframes heartbeat {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
}

.name {
    font-size: 2.5em;
    font-weight: 700;
    color: #333;
    margin-bottom: 15px;
    background: linear-gradient(135deg, #C8102E, #FFB000);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.title {
    font-size: 1.2em;
    color: #666;
    font-weight: 300;
}

/* Bio Section */
.bio-section {
    grid-area: bio;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(20px);
    border-radius: 25px;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
    padding: 40px;
}

.bio-section h2 {
    color: #C8102E;
    margin-bottom: 20px;
    font-size: 2em;
}

.bio-section p {
    color: #555;
    line-height: 1.8;
    margin-bottom: 15px;
    font-size: 1.05em;
}

/* Links Section */
.links-section {
    grid-area: links;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(20px);
    border-radius: 25px;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
    padding: 40px;
}

.links-section h2 {
    color: #C8102E;
    margin-bottom: 30px;
    font-size: 2em;
    text-align: center;
}

.links-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 15px;
}

.link {
    background: linear-gradient(135deg, #C8102E, #FFB000);
    color: white;
    text-decoration: none;
    padding: 15px 25px;
    border-radius: 50px;
    font-weight: 600;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
    font-size: 1.1em;
    text-align: center;
}

.link::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
    transition: left 0.5s;
}

.link:hover::before {
    left: 100%;
}

.link:hover {
    transform: translateY(-3px);
    box-shadow: 0 10px 25px rgba(200, 16, 46, 0.4);
}

/* Contact Section */
.contact-section {
    grid-area: contact;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(20px);
    border-radius: 25px;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
    padding: 40px;
    text-align: center;
}

.contact-section h2 {
    color: #C8102E;
    margin-bottom: 30px;
    font-size: 2em;
}

.social-link {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: linear-gradient(135deg, #C8102E, #FFB000);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    text-decoration: none;
    color: white;
    font-size: 1.8em;
    transition: all 0.3s ease;
}

.social-link:hover {
    transform: translateY(-3px) rotate(10deg);
    box-shadow: 0 8px 20px rgba(200, 16, 46, 0.4);
}

/* Carousel Section */
.carousel-section {
    grid-area: carousel;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(20px);
    border-radius: 25px;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
    padding: 40px;
}

.carousel-section h2 {
    color: #C8102E;
    margin-bottom: 30px;
    font-size: 2em;
    text-align: center;
}

.carousel-container {
    position: relative;
    max-width: 800px;
    margin: 0 auto;
    overflow: hidden;
    border-radius: 15px;
}

.carousel-wrapper {
    display: flex;
    transition: transform 0.5s ease-in-out;
}

.carousel-slide {
    min-width: 100%;
    position: relative;
}

.carousel-slide img {
    width: 100%;
    height: 500px;
    object-fit: cover;
    display: block;
    border-radius: 15px;
}

.carousel-caption {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: linear-gradient(to top, rgba(0, 0, 0, 0.8), transparent);
    color: white;
    padding: 30px 20px 20px;
    font-size: 1.1em;
    text-align: center;
    border-radius: 0 0 15px 15px;
}

.carousel-button {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background: rgba(255, 255, 255, 0.9);
    border: none;
    width: 50px;
    height: 50px;
    border-radius: 50%;
    cursor: pointer;
    font-size: 1.5em;
    color: #C8102E;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    z-index: 10;
}

.carousel-button:hover {
    background: white;
    transform: translateY(-50%) scale(1.1);
    box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
}

.carousel-button.prev {
    left: 20px;
}

.carousel-button.next {
    right: 20px;
}

.carousel-indicators {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin-top: 20px;
}

.indicator {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: #ddd;
    cursor: pointer;
    transition: all 0.3s ease;
}

.indicator.active {
    background: linear-gradient(135deg, #C8102E, #FFB000);
    width: 30px;
    border-radius: 6px;
}

/* Audio Visualizer Section */
.visualizer-section {
    grid-area: visualizer;
    background: rgba(79, 26, 27, 0.95);
    backdrop-filter: blur(20px);
    border-radius: 25px;
    box-shadow: none; 
    border: none; 
    padding: 20px; 
}

.visualizer-title {
    text-align: center;
    color: #a74849;
    margin-bottom: 10px;
    font-size: 2.2em;
    text-shadow: 0 0 20px rgba(141, 59, 60, 0.5);
}

.visualizer-subtitle {
    text-align: center;
    color: #e8a9aa;
    margin-bottom: 30px;
    font-size: 1.1em;
    font-style: italic;
}

#visualizer {
    width: 100%;
    height: 350px; 
    display: block; 
    background: linear-gradient(135deg, rgba(141, 59, 60, 0.1) 0%, rgba(79, 26, 27, 0.2) 100%);
    border-radius: 15px;
    margin-bottom: 30px;
    border: none; 
    box-shadow: none; 
}

.controls {
    display: flex;
    gap: 15px;
    justify-content: center;
    align-items: center;
    flex-wrap: wrap;
    margin-bottom: 20px;
}

.play-button {
    background: linear-gradient(135deg, #a74849 0%, #8d3b3c 100%);
    color: white;
    border: none;
    padding: 15px 30px;
    border-radius: 50px;
    font-size: 1.1em;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 8px 20px rgba(141, 59, 60, 0.4);
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
}

.play-button:hover {
    transform: translateY(-2px);
    box-shadow: 0 12px 30px rgba(141, 59, 60, 0.6);
}

.play-button:active {
    transform: translateY(0px);
}

.play-button.playing {
    background: linear-gradient(135deg, #c05658 0%, #ff0000 100%);
}

.time-display {
    color: #e8a9aa;
    font-size: 1.1em;
    font-weight: 600;
    min-width: 150px;
    text-align: center;
}

.progress-bar {
    width: 100%;
    height: 6px;
    background: rgba(141, 59, 60, 0.2);
    border-radius: 3px;
    cursor: pointer;
    overflow: hidden;
    margin-bottom: 10px;
}

.progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #8d3b3c, #a74849, #c05658);
    width: 0%;
    border-radius: 3px;
    box-shadow: 0 0 10px rgba(141, 59, 60, 0.8);
}

.visualizer-info {
    color: #e8a9aa;
    text-align: center;
    font-size: 0.95em;
    opacity: 0.8;
}

/* Video Filter Section */
.video-filter-section {
    grid-area: videofilter;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(20px);
    border-radius: 25px;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
    padding: 40px;
}

.video-filter-section h2 {
    color: #C8102E;
    margin-bottom: 30px;
    font-size: 2em;
    text-align: center;
}

.filter-controls {
    background: rgba(200, 16, 46, 0.05);
    border-radius: 15px;
    padding: 25px;
    margin-bottom: 30px;
}

.filter-controls h3 {
    color: #C8102E;
    margin-bottom: 20px;
    font-size: 1.3em;
}

.filter-buttons {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    gap: 10px;
}

.filter-btn {
    background: linear-gradient(135deg, #C8102E, #FFB000);
    color: white;
    border: none;
    padding: 12px 20px;
    border-radius: 10px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 0.95em;
}

.filter-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(200, 16, 46, 0.4);
}

.filter-btn.active {
    background: linear-gradient(135deg, #8d3b3c, #c05658);
    box-shadow: 0 0 20px rgba(141, 59, 60, 0.6);
}

.video-container {
    background: #000;
    border-radius: 15px;
    overflow: hidden;
    position: relative;
    max-width: 800px;
    margin: 0 auto;
}

#sourceVideo {
    display: none;
}

#outputCanvas {
    width: 100%;
    display: block;
    border-radius: 15px;
}

/* WebRTC Section */
.webrtc-section {
    grid-area: webrtc;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(20px);
    border-radius: 25px;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
    padding: 40px;
}

.webrtc-section h2 {
    color: #C8102E;
    margin-bottom: 30px;
    font-size: 2em;
    text-align: center;
}

.call-controls {
    text-align: center;
    margin-bottom: 30px;
}

.call-button {
    background: linear-gradient(135deg, #C8102E, #FFB000);
    color: white;
    border: none;
    padding: 15px 40px;
    border-radius: 50px;
    font-size: 1.2em;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 8px 20px rgba(200, 16, 46, 0.4);
}

.call-button:hover {
    transform: translateY(-2px);
    box-shadow: 0 12px 30px rgba(200, 16, 46, 0.6);
}

.call-button:disabled {
    background: #ccc;
    cursor: not-allowed;
    transform: none;
}

.video-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-bottom: 30px;
}

.video-wrapper {
    background: #000;
    border-radius: 15px;
    overflow: hidden;
    position: relative;
}

.video-wrapper video {
    width: 100%;
    height: 300px;
    object-fit: cover;
    display: block;
}

.video-label {
    position: absolute;
    top: 10px;
    left: 10px;
    background: rgba(200, 16, 46, 0.9);
    color: white;
    padding: 8px 15px;
    border-radius: 20px;
    font-size: 0.9em;
    font-weight: 600;
}

.chat-container {
    background: rgba(200, 16, 46, 0.05);
    border-radius: 15px;
    padding: 20px;
}

.chat-messages {
    height: 200px;
    overflow-y: auto;
    margin-bottom: 15px;
    padding: 15px;
    background: white;
    border-radius: 10px;
}

.message {
    margin-bottom: 10px;
    padding: 10px 15px;
    border-radius: 10px;
    max-width: 70%;
}

.message.local {
    background: linear-gradient(135deg, #C8102E, #FFB000);
    color: white;
    margin-left: auto;
    text-align: right;
}

.message.remote {
    background: #f0f0f0;
    color: #333;
}

.message-sender {
    font-weight: 600;
    font-size: 0.85em;
    margin-bottom: 5px;
}

.message-text {
    font-size: 0.95em;
}

.chat-input-area {
    display: flex;
    gap: 10px;
}

.chat-input {
    flex: 1;
    padding: 12px 20px;
    border: 2px solid #ddd;
    border-radius: 25px;
    font-size: 1em;
    outline: none;
    transition: border-color 0.3s ease;
}

.chat-input:focus {
    border-color: #C8102E;
}

.send-button {
    background: linear-gradient(135deg, #C8102E, #FFB000);
    color: white;
    border: none;
    padding: 12px 30px;
    border-radius: 25px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
}

.send-button:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(200, 16, 46, 0.4);
}

/* Game Link Section */
.game-link-section {
    grid-area: gamelink;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(20px);
    border-radius: 25px;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
    padding: 50px;
    text-align: center;
}

.game-link-section h2 {
    color: #C8102E;
    margin-bottom: 20px;
    font-size: 2.5em;
}

.game-description {
    color: #666;
    font-size: 1.2em;
    margin-bottom: 30px;
    line-height: 1.6;
}

.game-link-btn {
    display: inline-block;
    background: linear-gradient(135deg, #C8102E, #FFB000);
    color: white;
    text-decoration: none;
    padding: 20px 60px;
    border-radius: 50px;
    font-size: 1.5em;
    font-weight: bold;
    transition: all 0.3s ease;
    box-shadow: 0 8px 25px rgba(200, 16, 46, 0.4);
}

.game-link-btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 12px 35px rgba(200, 16, 46, 0.6);
}

.game-link-btn:active {
    transform: translateY(-1px);
}

/* Media Queries */
@media (min-width: 768px) {
    .main-container {
        grid-template-columns: repeat(2, 1fr);
        grid-template-areas:
            "profile profile"
            "bio bio"
            "links links"
            "contact contact"
            "carousel carousel"
            "visualizer visualizer"
            "videofilter videofilter"
            "webrtc webrtc"
            "gamelink gamelink";    
        gap: 25px;
    }

    .links-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 20px;
    }

    .carousel-slide img {
        height: 450px;
    }
    
    #visualizer {
        height: 300px;
    }
}

@media (min-width: 1024px) {
    .main-container {
        grid-template-columns: 1fr 2fr;
        grid-template-areas:
            "profile bio"
            "profile links"
            "contact contact"
            "carousel carousel"
            "visualizer visualizer"
            "videofilter videofilter"
            "webrtc webrtc"
            "gamelink gamelink";   
        gap: 30px;
    }

    .visualizer-section {
        padding: 30px; 
    }
    
    #visualizer {
        height: 380px; 
    }
}

@media (min-width: 1200px) {
    .main-container {
        grid-template-columns: 1fr 1.5fr 1.5fr;
        grid-template-areas:
            "profile bio links"
            "contact contact contact"
            "carousel carousel carousel"
            "visualizer visualizer visualizer"
            "videofilter videofilter videofilter"
            "webrtc webrtc webrtc"
            "gamelink gamelink gamelink";
        gap: 30px;
    }
}

@media (max-width: 768px) {
    .video-grid {
        grid-template-columns: 1fr;
    }
    
    .video-wrapper video {
        height: 250px;
    }
}

@media (max-width: 480px) {
    .visualizer-section {
        padding: 15px;
    }
    
    #visualizer {
        height: 200px;
    }
    
    .filter-buttons {
        grid-template-columns: 1fr;
    }
}
    </style>
</head>
<body>
    <div class="main-container">
        <section class="profile-section">
            <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRAEK3JKphLGBwbwQ5lpm7sVru95qJRjga9nQ&s" alt="Alessandro Zocchi" class="profile-image">
            <h1 class="name">Alessandro Zocchi</h1>
            <p class="title">Master's Student in Business Intelligence & Analytics</p>
        </section>

        <section class="bio-section">
            <h2>About Me</h2>
            <p>I'm Alessandro Zocchi, I am 23 years old and I come from Rome, in Italy.</p>
            
            <p>I am pretty curious about things and eager to learn, that's why I decided to go study abroad with the Erasmus programm.</p>
            
            <p>Talking more about personal stuff, I really like to cook, that's why I always watch cooking vids on YouTube. In addition,
            I really enjoy listening to music and I like to explore new genres. Moreover I'm a very passionate fan of As Roma, the club of my city.</p>
        </section>

        <section class="links-section">
            <h2>My Interests</h2>
            <div class="links-grid">
                <a href="https://www.youtube.com/@ChefMaxMariola" target="_blank" class="link">üë®‚Äçüç≥ Chef Max Mariola</a>
                <a href="https://stats.fm/sagghe" target="_blank" class="link">üéµ My Music Stats</a>
                <a href="https://www.asroma.com/it" target="_blank" class="link">‚öΩ AS Roma Official</a>
            </div>
        </section>

        <section class="contact-section">
            <h2>Get In Touch</h2>
            <a href="mailto:zocchi.2021766@studenti.uniroma1.it" class="social-link" title="Email">‚úâÔ∏è</a>
        </section>

        <section class="carousel-section">
            <h2>Gallery</h2>
            <div class="carousel-container">
                <button class="carousel-button prev" onclick="changeSlide(-1)">‚óÄ</button>
                
                <div class="carousel-wrapper" id="carouselWrapper">
                    <div class="carousel-slide">
                        <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQ8Sk9zmA9tF_Ke2sxQlWG7iTIUg0gMp-EgdQ&s" alt="Francesco Totti celebration">
                        <div class="carousel-caption">Francesco Totti iconic celebration in the "Derby della Capitale"</div>
                    </div>
                    <div class="carousel-slide">
                        <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRYGd60SGqgrDw-euNiETbeZXXSwOLzIL-4vg&s" alt="Chef Max Mariola cooking">
                        <div class="carousel-caption">Chef Max Mariola cooking pasta tossing it in a pan</div>
                    </div>
                    <div class="carousel-slide">
                        <img src="https://i.pinimg.com/1200x/ac/95/f2/ac95f264bed9cf982cc09220246316bd.jpg" alt="Jazz fusion album">
                        <div class="carousel-caption">Great jazz-fusion album I've been listening to lately</div>
                    </div>
                </div>
                
                <button class="carousel-button next" onclick="changeSlide(1)">‚ñ∂</button>
            </div>
            
            <div class="carousel-indicators">
                <span class="indicator active" onclick="goToSlide(0)"></span>
                <span class="indicator" onclick="goToSlide(1)"></span>
                <span class="indicator" onclick="goToSlide(2)"></span>
            </div>
        </section>

        <section class="visualizer-section">
            <h1 class="visualizer-title">üéµ Audio Visualizer</h1>
            <p class="visualizer-subtitle">"Trance Dance" - Jazz Fusion</p>
            
            <canvas id="visualizer"></canvas>
            
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            
            <div class="controls">
                <button class="play-button" id="playButton">
                    ‚ñ∂ Click here to listen (and visualize!) to my favourite song in the album, "Trance Dance"
                </button>
                <div class="time-display" id="timeDisplay">0:00 / 0:00</div>
            </div>
            
            <div class="visualizer-info">
                üéß High-quality audio visualization with frequency analysis
            </div>
        </section>

        <section class="video-filter-section">
            <h2>üé¨ Real-Time Video Filters</h2>
            
            <div class="filter-controls">
                <h3>Choose a Filter:</h3>
                <div class="filter-buttons">
                    <button class="filter-btn active" onclick="setFilter('normal')">Normal</button>
                    <button class="filter-btn" onclick="setFilter('grayscale')">Grayscale</button>
                    <button class="filter-btn" onclick="setFilter('sepia')">Sepia</button>
                    <button class="filter-btn" onclick="setFilter('invert')">Invert</button>
                    <button class="filter-btn" onclick="setFilter('bloody')">Bloody Brown</button>
                    <button class="filter-btn" onclick="setFilter('blur')">Blur</button>
                    <button class="filter-btn" onclick="setFilter('brightness')">Brightness</button>
                    <button class="filter-btn" onclick="setFilter('contrast')">Contrast</button>
                </div>
            </div>
            
            <div class="video-container">
                <video id="sourceVideo" src="chickcorea.mp4" autoplay loop muted playsinline></video>
                <canvas id="outputCanvas"></canvas>
            </div>
        </section>

        <section class="webrtc-section">
            <h2>üìπ WebRTC Video Chat</h2>
            
            <div class="call-controls">
                <button class="call-button" id="startCallBtn">Start Call</button>
            </div>
            
            <div class="video-grid">
                <div class="video-wrapper">
                    <video id="localVideo" autoplay muted playsinline></video>
                    <div class="video-label">You (Caller)</div>
                </div>
                <div class="video-wrapper">
                    <video id="remoteVideo" autoplay playsinline></video>
                    <div class="video-label">Remote (Answerer)</div>
                </div>
            </div>
            
            <div class="chat-container">
                <div class="chat-messages" id="chatMessages"></div>
                <div class="chat-input-area">
                    <input type="text" class="chat-input" id="chatInput" placeholder="Type a message...">
                    <button class="send-button" id="sendBtn">Send</button>
                </div>
            </div>

        </section>
                <section class="game-link-section">
            <h2>üéÆ Play My Tilt Game!</h2>
            <p class="game-description">Control the game by tilting your phone. Dodge obstacles and score points!</p>
            <a href="game_ai/gameai.html" class="game-link-btn">PLAY NOW</a>
        </section>
    </div>

    <script>
        // ===== CAROUSEL FUNCTIONALITY (unchanged) =====
        let currentSlide = 0;
        const totalSlides = 3;

        function changeSlide(direction) {
            currentSlide += direction;
            
            if (currentSlide < 0) {
                currentSlide = totalSlides - 1;
            } else if (currentSlide >= totalSlides) {
                currentSlide = 0;
            }
            
            updateCarousel();
        }

        function goToSlide(index) {
            currentSlide = index;
            updateCarousel();
        }

        function updateCarousel() {
            const wrapper = document.getElementById('carouselWrapper');
            if (wrapper) {
                wrapper.style.transform = `translateX(-${currentSlide * 100}%)`;
            }
            
            const indicators = document.querySelectorAll('.indicator');
            indicators.forEach((indicator, index) => {
                if (index === currentSlide) {
                    indicator.classList.add('active');
                } else {
                    indicator.classList.remove('active');
                }
            });
        }

        // ===== AUDIO VISUALIZER FUNCTIONALITY (Updated) =====
        const canvas = document.getElementById('visualizer');
        const ctx = canvas ? canvas.getContext('2d') : null; 
        const playButton = document.getElementById('playButton');
        const timeDisplay = document.getElementById('timeDisplay');
        const progressFill = document.getElementById('progressFill');

        if (!canvas || !ctx) {
            console.error("Canvas or context not found. Visualizer functionality disabled.");
        } else {
            function resizeCanvas() {
                canvas.width = canvas.offsetWidth;
                canvas.height = canvas.offsetHeight;
            }
            resizeCanvas();
            window.addEventListener('resize', resizeCanvas);

            let audioContext;
            let analyser;
            let audioBuffer;
            let sourceNode;
            let isPlaying = false;
            let startTime = 0;
            let animationId;

            const colors = {
                primary: '#8d3b3c',
                secondary: '#a74849',
                accent: '#c05658',
                dark: '#4f1a1b',
                light: '#e8a9aa'
            };

            const playButton_click = async () => {
                if (!audioContext) {
                    audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    analyser = audioContext.createAnalyser();
                    analyser.fftSize = 64; 
                    analyser.smoothingTimeConstant = 0.85;
                    analyser.connect(audioContext.destination);
                }

                if (audioContext.state === 'suspended') {
                    await audioContext.resume();
                }

                if (isPlaying) {
                    if (sourceNode) {
                        sourceNode.stop();
                    }
                    isPlaying = false;
                    playButton.classList.remove('playing');
                    playButton.textContent = '‚ñ∂ Click here to listen (and visualize!) to my favourite song in the album, "Trance Dance"';
                    cancelAnimationFrame(animationId);
                } else {
                    if (!audioBuffer) {
                        try {
                            playButton.textContent = 'Loading audio...';
                            const response = await fetch('Trance Dance.mp3'); 
                            const arrayBuffer = await response.arrayBuffer();
                            audioBuffer = await audioContext.decodeAudioData(arrayBuffer);
                        } catch (error) {
                            console.error('Error loading audio:', error);
                            alert('Could not load audio file. Make sure "Trance Dance.mp3" is in the same folder as this HTML file.');
                            playButton.textContent = '‚ñ∂ Click here to listen (and visualize!) to my favourite song in the album, "Trance Dance"';
                            return;
                        }
                    }

                    sourceNode = audioContext.createBufferSource();
                    sourceNode.buffer = audioBuffer;
                    sourceNode.connect(analyser);
                    analyser.connect(audioContext.destination);

                    sourceNode.onended = () => {
                        if (isPlaying) {
                            isPlaying = false;
                            playButton.classList.remove('playing');
                            playButton.textContent = '‚ñ∂ Click here to listen (and visualize!) to my favourite song in the album, "Trance Dance"';
                            timeDisplay.textContent = '0:00 / ' + formatTime(audioBuffer.duration);
                            progressFill.style.width = '0%';
                            cancelAnimationFrame(animationId);
                        }
                    };

                    startTime = audioContext.currentTime;
                    sourceNode.start(0);
                    isPlaying = true;
                    playButton.classList.add('playing');
                    playButton.textContent = '‚è∏ Stop';

                    animate();
                }
            };

            if (playButton) {
                playButton.addEventListener('click', playButton_click);
            }

            function formatTime(seconds) {
                const minutes = Math.floor(seconds / 60);
                const secs = Math.floor(seconds % 60);
                return `${minutes}:${secs < 10 ? '0' : ''}${secs}`;
            }

            function animate() {
                animationId = requestAnimationFrame(animate);

                const dataArray = new Uint8Array(analyser.frequencyBinCount);
                analyser.getByteFrequencyData(dataArray);

                if (audioBuffer) {
                    const currentTime = audioContext.currentTime - startTime;
                    const duration = audioBuffer.duration;
                    timeDisplay.textContent = `${formatTime(currentTime)} / ${formatTime(duration)}`;
                    progressFill.style.width = `${(currentTime / duration) * 100}%`;
                }

                ctx.fillStyle = 'rgba(79, 26, 27, 0.2)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);

                drawVisualization(dataArray);
            }

                        function drawVisualization(dataArray) {
                const barWidth = (canvas.width / dataArray.length) * 2.5;
                let x = 0;
                ctx.clearRect(0, 0, canvas.width, canvas.height);

                for (let i = 0; i < dataArray.length; i++) {
                    const barHeight = dataArray[i] * 1.2;
                    const gradient = ctx.createLinearGradient(0, canvas.height, 0, canvas.height - barHeight);
                    gradient.addColorStop(0, colors.dark);
                    gradient.addColorStop(0.5, colors.primary);
                    gradient.addColorStop(1, colors.accent);
                    ctx.fillStyle = gradient;
                    ctx.fillRect(x, canvas.height - barHeight, barWidth, barHeight);
                    x += barWidth + 1;
                }
            }
        }

        // ===== REAL-TIME VIDEO FILTER FUNCTIONALITY =====
         const video = document.getElementById('sourceVideo');
    const canvasOut = document.getElementById('outputCanvas');
    const ctxOut = canvasOut.getContext('2d');
    let currentFilter = 'normal';
    const filterButtons = document.querySelectorAll('.filter-btn');

    // Forza l'autoplay anche se bloccato
    video.addEventListener('canplay', () => {
        video.play().catch(err => console.warn('‚ö†Ô∏è Autoplay bloccato:', err));
        requestAnimationFrame(drawVideoFrame);
    });

    // Rendi invisibile ma renderizzabile
    video.style.position = 'absolute';
    video.style.opacity = '0';
    video.style.pointerEvents = 'none';

    // Gestione selezione filtro
    function setFilter(filter) {
        currentFilter = filter;
        filterButtons.forEach(btn => btn.classList.remove('active'));
        const activeBtn = Array.from(filterButtons).find(btn => 
            btn.textContent.toLowerCase().includes(filter)
        );
        if (activeBtn) activeBtn.classList.add('active');
    }

    // Applica filtro pixel-based
    function applyFilter(imageData) {
        const data = imageData.data;
        for (let i = 0; i < data.length; i += 4) {
            const r = data[i], g = data[i + 1], b = data[i + 2];
            switch (currentFilter) {
                case 'grayscale':
                    const gray = 0.3 * r + 0.59 * g + 0.11 * b;
                    data[i] = data[i + 1] = data[i + 2] = gray;
                    break;
                case 'sepia':
                    data[i] = 0.393 * r + 0.769 * g + 0.189 * b;
                    data[i + 1] = 0.349 * r + 0.686 * g + 0.168 * b;
                    data[i + 2] = 0.272 * r + 0.534 * g + 0.131 * b;
                    break;
                case 'invert':
                    data[i] = 255 - r;
                    data[i + 1] = 255 - g;
                    data[i + 2] = 255 - b;
                    break;
                case 'bloody':
                    const redish = r * 1.1 + 40;
                    const greenish = g * 0.4 + 15;
                    const bluish = b * 0.3;
                    data[i] = Math.min(255, redish);
                    data[i + 1] = Math.min(255, greenish);
                    data[i + 2] = Math.min(255, bluish);
                    break;
                default:
                    break;
            }
        }
        return imageData;
    }

    // Disegna il frame video + filtro
    function drawVideoFrame() {
        if (video.readyState >= 2) {
            canvasOut.width = video.videoWidth;
            canvasOut.height = video.videoHeight;
            ctxOut.drawImage(video, 0, 0, canvasOut.width, canvasOut.height);

            if (['grayscale', 'sepia', 'invert', 'bloody'].includes(currentFilter)) {
                const frame = ctxOut.getImageData(0, 0, canvasOut.width, canvasOut.height);
                const filteredFrame = applyFilter(frame);
                ctxOut.putImageData(filteredFrame, 0, 0);
            } else {
                ctxOut.filter = currentFilter === 'blur' ? 'blur(4px)' :
                                currentFilter === 'brightness' ? 'brightness(1.3)' :
                                currentFilter === 'contrast' ? 'contrast(1.4)' : 'none';
                ctxOut.drawImage(video, 0, 0, canvasOut.width, canvasOut.height);
                ctxOut.filter = 'none';
            }
        }
        requestAnimationFrame(drawVideoFrame);
    }


    // ===== WEBRTC VIDEO CHAT FUNCTIONALITY =====
let localStream;
let peerConnection;
const localVideo = document.getElementById('localVideo');
const remoteVideo = document.getElementById('remoteVideo');
const startCallBtn = document.getElementById('startCallBtn');
const chatMessages = document.getElementById('chatMessages');
const chatInput = document.getElementById('chatInput');
const sendBtn = document.getElementById('sendBtn');

const configuration = {
    iceServers: [{ urls: 'stun:stun.l.google.com:19302' }]
};

// Start call
startCallBtn.addEventListener('click', async () => {
    try {
        // Get local media
        localStream = await navigator.mediaDevices.getUserMedia({ 
            video: true, 
            audio: true 
        });
        localVideo.srcObject = localStream;

        // Create peer connection
        peerConnection = new RTCPeerConnection(configuration);

        // Add local stream tracks to peer connection
        localStream.getTracks().forEach(track => {
            peerConnection.addTrack(track, localStream);
        });

        // Handle incoming tracks (simulate remote)
        peerConnection.ontrack = (event) => {
            remoteVideo.srcObject = event.streams[0];
        };

        // Create offer
        const offer = await peerConnection.createOffer();
        await peerConnection.setLocalDescription(offer);

        // Simulate answer (same stream as local)
        setTimeout(async () => {
            await peerConnection.setRemoteDescription(offer);
            const answer = await peerConnection.createAnswer();
            await peerConnection.setLocalDescription(answer);
            
            // Set remote video to same stream (simulation)
            remoteVideo.srcObject = localStream;
        }, 500);

        startCallBtn.textContent = 'Call Active';
        startCallBtn.disabled = true;
    } catch (error) {
        console.error('Error starting call:', error);
        alert('Could not access camera/microphone');
    }
});

// Send message
function sendMessage() {
    const message = chatInput.value.trim();
    if (message === '') return;

    // Add local message
    addMessage('You', message, 'local');

    // Simulate remote response (echo)
    setTimeout(() => {
        addMessage('Remote', message, 'remote');
    }, 500);

    chatInput.value = '';
}

function addMessage(sender, text, type) {
    const messageDiv = document.createElement('div');
    messageDiv.className = `message ${type}`;
    
    const senderDiv = document.createElement('div');
    senderDiv.className = 'message-sender';
    senderDiv.textContent = sender;
    
    const textDiv = document.createElement('div');
    textDiv.className = 'message-text';
    textDiv.textContent = text;
    
    messageDiv.appendChild(senderDiv);
    messageDiv.appendChild(textDiv);
    chatMessages.appendChild(messageDiv);
    
    // Auto scroll to bottom
    chatMessages.scrollTop = chatMessages.scrollHeight;
}

sendBtn.addEventListener('click', sendMessage);
chatInput.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') sendMessage();
});
</script>
</body>
</html>
